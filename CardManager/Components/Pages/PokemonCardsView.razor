@* Usings *@
@using CardManager.Models.Grading
@using CardManager.Components.Pages.Modals
@using CardManager.ViewModels.PokemonCollectionViewModels

@* View Config *@
@page "/pokemon"
@rendermode InteractiveServer

@inherits BaseInjectView<IPokemonCollectionViewModel>

<PageTitle>Pokemon Cards</PageTitle>

<h1>Pokemon Cards</h1>

<div class="card-grid-container">
    <Grid @ref="cardsGrid"
          TItem="IPokemonCardViewModel"
          Class="table table-hover table-responsive table-sm"
          DataProvider="@ViewModel.CardsDataProvider"
          OnRowDoubleClick="@ViewModel.CardRowDoubleClicked"
          SelectedItemsChanged="@ViewModel.OnSelectedCardsChanged"
          AllowSorting="true"
          AllowRowClick="true"
          AllowSelection="true"
          AllowPaging="false"
          ItemsPerPageText=""
          Responsive="true"
          PaginationItemsTextFormat=""
          PageSizeSelectorItems="pageSizeSelectors"
          SelectionMode="GridSelectionMode.Multiple">
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Name" PropertyName="Name" SortKeySelector="card => card.Name">
            @context.Name
        </GridColumn> 
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="#" PropertyName="Number">
            @context.Number
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Year" PropertyName="CreationYear">
            @context.CreationYear
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Storage">
            <div>@context.StorageMedia</div>
            <div>@context.StorageLocation</div>
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Grade" PropertyName="Grading">
            @context.Grading
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Series" PropertyName="Series">
            @context.Series
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Rarity" PropertyName="Rarity">
            @context.Rarity
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Holo" PropertyName="Holographic">
            @context.Holographic
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="Type" PropertyName="Type">
            @context.Type
        </GridColumn>
        <GridColumn TItem="IPokemonCardViewModel" HeaderText="$$" PropertyName="MonetaryData" SortKeySelector="card => card.MonetaryData.MavinViewModel.AveragePrice">
            <div>Min: $@context.MonetaryData.MavinViewModel.MinPrice</div>
            <div>Avg: $@context.MonetaryData.MavinViewModel.AveragePrice</div>
            <div>Max: $@context.MonetaryData.MavinViewModel.MaxPrice</div>
        </GridColumn>
@*         <GridColumn TItem="IPokemonCardViewModel" HeaderText="Edit" PropertyName="Edit">
            <Button Color="ButtonColor.Primary"
                    Size="Size.ExtraSmall"
                    @onclick="@((args) => ViewModel.CardEditClicked(context))">
                Edit
            </Button>
        </GridColumn> *@
    </Grid>

    <EditCardModal @ref="editCardModal"></EditCardModal>

    <div class="card-table-buttons">
        <Button Color="ButtonColor.Primary" Size="Size.Small" @onclick="ViewModel.AddCard">Add Card</Button>
        <Button Color="ButtonColor.Primary" Size="Size.Small" @onclick="ViewModel.SaveTable">Save</Button>
        <Button Color="ButtonColor.Primary" Size="Size.Small" @onclick="ViewModel.RetrieveAppraisals">Retrieve Appraisals</Button>
    </div>
</div>

